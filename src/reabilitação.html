<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recursos de Reabilitação | Viva Bem+</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body class="bg-gray-50 font-sans">
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 flex justify-between items-center py-4">
      <a href="mainpage.html" class="text-2xl font-bold text-purple-600 flex items-center">
        <i class="fas fa-heartbeat mr-2"></i> Viva Bem+
      </a>
      <nav class="hidden md:flex space-x-6 items-center" id="navbar">
        <a href="mainpage.html" class="text-gray-700 hover:text-purple-600 font-medium">Início</a>
        <a href="features.html" class="text-gray-700 hover:text-purple-600 font-medium">Funcionalidades</a>
        <a href="reabilitacao.html" class="text-purple-600 font-medium">Reabilitação</a>
        <a href="about.html" class="text-gray-700 hover:text-purple-600 font-medium">Sobre Nós</a>
        <a href="contact.html" class="text-gray-700 hover:text-purple-600 font-medium">Contactos</a>
        <a href="#" id="auth-link" class="text-white bg-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition"></a>
        <button id="logout-btn" class="hidden text-sm text-red-600 hover:underline ml-2">Sair</button>
      </nav>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8">
    <section class="text-center mb-12">
      <h1 class="text-4xl font-bold text-purple-700 mb-4">Recursos de Reabilitação</h1>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">Jogos interativos e exercícios físicos para promover a saúde e bem-estar</p>
    </section>

    <section class="mb-16">
      <h2 class="text-3xl font-bold mb-8 text-center">Jogos Terapêuticos</h2>
      <div class="grid md:grid-cols-2 gap-8">
        <!-- Memory Game -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition">
          <div class="h-48 bg-purple-600 flex items-center justify-center">
            <i class="fas fa-brain text-white text-6xl"></i>
          </div>
          <div class="p-6">
            <h3 class="text-2xl font-bold mb-3">Jogo da Memória</h3>
            <p class="text-gray-600 mb-2">
              Melhore a sua memória e concentração com pares combinados.
              <br><span id="memory-score" class="block mt-2 font-medium text-purple-700"></span>
            </p>
            <a href="games/memory/index.html" class="inline-block bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition">Jogar Agora</a>
          </div>
        </div>

        <!-- Crossword -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition">
          <div class="h-48 bg-blue-600 flex items-center justify-center">
            <i class="fas fa-font text-white text-6xl"></i>
          </div>
          <div class="p-6">
            <h3 class="text-2xl font-bold mb-3">Palavras Cruzadas</h3>
            <p class="text-gray-600 mb-2">
              Exercite o vocabulário e raciocínio com desafios de palavras.
              <br><span id="crossword-score" class="block mt-2 font-medium text-blue-700"></span>
            </p>
            <a href="games/crossword/index.html" class="inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Jogar Agora</a>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h2 class="text-3xl font-bold mb-8 text-center">Vídeos de Exercícios para Idosos</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Vídeos seguros -->
        <iframe class="w-full h-64 rounded-lg shadow" src="https://www.youtube.com/embed/8BcPHWGQO44" title="Exercício para Idosos Sentados" allowfullscreen></iframe>
        <iframe class="w-full h-64 rounded-lg shadow" src="https://www.youtube.com/embed/IH45aj2uOxI" title="Exercícios de Mobilidade Leve" allowfullscreen></iframe>
        <iframe class="w-full h-64 rounded-lg shadow" src="https://www.youtube.com/embed/lxg4gkS-U54" title="Alongamento Simples para Idosos" allowfullscreen></iframe>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-white py-12 mt-12">
    <div class="container mx-auto px-4 text-center">
      <p>&copy; Viva Bem+. Todos os direitos reservados.</p>
    </div>
  </footer>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBMwJEeBE1tfT-wVPJ8c2lSlEmuqYEuqnY",
      authDomain: "projeto-final-de-curso-425a9.firebaseapp.com",
      projectId: "projeto-final-de-curso-425a9",
      storageBucket: "projeto-final-de-curso-425a9.appspot.com",
      messagingSenderId: "475780755633",
      appId: "1:475780755633:web:6dbf97c6b394134e91f290"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const authLink = document.getElementById('auth-link');
    const logoutBtn = document.getElementById('logout-btn');

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        const userDoc = await getDoc(doc(db, "users", user.uid));
        const role = userDoc.exists() ? userDoc.data().role : "paciente";
        authLink.innerHTML = role === "profissional" ? '<i class="fas fa-user-md mr-2"></i> Área do Profissional' : '<i class="fas fa-user mr-2"></i> Área do Paciente';
        authLink.href = role === "profissional" ? "dashboardprofissional.html" : "dashboardpaciente.html";
        logoutBtn.classList.remove("hidden");

        // Load scores
        const personalScore = await getDoc(doc(db, "user_scores", user.uid));
        const memoryScore = personalScore.exists() && personalScore.data().memory ? personalScore.data().memory : "Sem registo";
        const crosswordScore = personalScore.exists() && personalScore.data().crossword ? personalScore.data().crossword : "Sem registo";

        document.getElementById("memory-score").textContent = `O seu recorde: ${memoryScore}`;
        document.getElementById("crossword-score").textContent = `O seu recorde: ${crosswordScore}`;
      } else {
        authLink.textContent = "Entrar";
        authLink.href = "login1.html";
        logoutBtn.classList.add("hidden");
      }

      // Load global high scores
      const memoryGlobal = await getDoc(doc(db, "game_high_scores", "memory"));
      const crosswordGlobal = await getDoc(doc(db, "game_high_scores", "crossword"));

      const memoryVal = memoryGlobal.exists() ? memoryGlobal.data().score : "---";
      const crosswordVal = crosswordGlobal.exists() ? crosswordGlobal.data().score : "---";

      document.getElementById("memory-score").textContent += ` | Global: ${memoryVal}`;
      document.getElementById("crossword-score").textContent += ` | Global: ${crosswordVal}`;
    });

    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "index.html";
    });
  </script>
</body>
</html>
